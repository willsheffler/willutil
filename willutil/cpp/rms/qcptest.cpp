#include <iostream>

#include "willutil/cpp/rms/qcp.hpp"

int main(int argc, char *argv[]) {

  using namespace willutil::rms::qcp;
  using namespace std;

  // RowMatrixX<float> pts1(10, 3), pts2(10, 3);
  // pts1 << -0.86690736, -1.5878147, -1.8043715, -1.6571901, 0.21296176,
  // 0.7062808, 0.06935676, -0.42670485, 0.7014818, -0.3290541, -0.6076911,
  // 2.21716, 0.19452481, 0.49057415, 2.0037787, 1.253971, 0.06457297,
  // 1.6773283, 0.29036164, -0.07144547, 0.4459427, 0.00547969, -1.1086875,
  // -1.1432686, -0.34444395, -3.0557382, 0.97099686, -0.40596142, -0.94199985,
  // 0.8786275;
  // pts2 << 0.38644534, -1.3605859, -2.8360791, 0.91723466, -0.20715618,
  // 0.08942592, 1.1657169, 0.98629785, -1.2904598, 2.38504, 1.3327953,
  // -0.35133362, 1.3891119, 2.0143983, -0.08790037, 1.3431536, 2.580061,
  // -1.1311582, 0.7091534, 1.158997, -1.3360386, 0.39351285, -0.17629895,
  // -2.6776707, 3.2835355, -0.07852721, -2.5300875, 1.7134084, 0.516755,
  // -1.2414658;

  RowMatrixX<double> xyz1(7, 3), xyz2(7, 3);
  xyz1(0, 0) = -2.803;
  xyz1(0, 1) = -15.373;
  xyz1(0, 2) = 24.556;
  xyz1(1, 0) = 0.893;
  xyz1(1, 1) = -16.062;
  xyz1(1, 2) = 25.147;
  xyz1(2, 0) = 1.368;
  xyz1(2, 1) = -12.371;
  xyz1(2, 2) = 25.885;
  xyz1(3, 0) = -1.651;
  xyz1(3, 1) = -12.153;
  xyz1(3, 2) = 28.177;
  xyz1(4, 0) = -0.440;
  xyz1(4, 1) = -15.218;
  xyz1(4, 2) = 30.068;
  xyz1(5, 0) = 2.551;
  xyz1(5, 1) = -13.273;
  xyz1(5, 2) = 31.372;
  xyz1(6, 0) = 0.105;
  xyz1(6, 1) = -11.330;
  xyz1(6, 2) = 33.567;
  xyz2(0, 0) = -14.739;
  xyz2(0, 1) = -18.673;
  xyz2(0, 2) = 15.040;
  xyz2(1, 0) = -12.473;
  xyz2(1, 1) = -15.810;
  xyz2(1, 2) = 16.074;
  xyz2(2, 0) = -14.802;
  xyz2(2, 1) = -13.307;
  xyz2(2, 2) = 14.408;
  xyz2(3, 0) = -17.782;
  xyz2(3, 1) = -14.852;
  xyz2(3, 2) = 16.171;
  xyz2(4, 0) = -16.124;
  xyz2(4, 1) = -14.617;
  xyz2(4, 2) = 19.584;
  xyz2(5, 0) = -15.029;
  xyz2(5, 1) = -11.037;
  xyz2(5, 2) = 18.902;
  xyz2(6, 0) = -18.577;
  xyz2(6, 1) = -10.001;
  xyz2(6, 2) = 17.996;

  auto rms = qcp_rmsd(xyz1, xyz2);

  cout << "rms " << rms << " should == 0.719106" << endl;

  std::cout << "qcptest.cpp DONE" << std::endl;
  return 0;
}
